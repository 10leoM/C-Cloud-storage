收到。按 WebMem 现有目录与能力，对你当前 mymuduo 需要补齐/实现的内容汇总（仅保留核心“要做”清单，去掉之前 M0 额外工程化步骤）：

核心差距总览（优先级: P0> P1 > P2）
P0 网络/HTTP 必须增强
P1 云存储业务必备
P2 优化与增强

P0 必须增强（底座 + HTTP）
1. 回调体系补齐  
   - Channel: closeCallback / errorCallback / disableAll / disableReading  
   - Connection: writeCompleteCallback / highWaterMarkCallback / closeCallback / error处理 / shutdown()/forceClose() / 半关闭状态  
   - 分离 Connection 与 HTTP（改为通用 context: std::shared_ptr<void>）
2. Acceptor / Server  
   - newConnection 传 localAddr & peerAddr  
   - 移除 Acceptor::Connect，若需要客户端做独立 Connector/TcpClient
3. Buffer  
   - 改用 size_t 索引  
   - 实现 readFd(writev) / prependXxx(int32 等) / findCRLF / retrieveUntil  
   - 高水位阈值配合回调
4. HTTP 层  
   - HttpServer: 回调签名改 bool(Conn, Request&, Response*) 支持同步/异步  
   - HttpContext: 状态机扩展 (headersComplete / gotAll / isChunked / remainingLength) + 可挂自定义子 context  
   - HttpRequest: 增强路径参数 setPathParams/getPathParam + Query 解析 + urlDecode  
   - HttpResponse: 支持 async 标记、Content-Range / Accept-Ranges、appendToBuffer统一输出  
5. 路由  
   - 引入 RouteTrie 或正则路由表 + 动态参数注入  
6. 错误 / 关闭处理  
   - 在 Epoll 轮询中检测 EPOLLERR / EPOLLHUP / EPOLLRDHUP 并映射到 Channel error/close 回调  
7. 定时/任务  
   -（可复用已有）补 session/上传超时需要的定时接口（RunAfter / RunEvery）

P1 云存储业务功能
1. 数据库接入  
   - MySQL 连接封装（执行 / 查询）  
   - 导入 file_manager.sql（users / sessions / files / file_shares）  
2. 会话管理  
   - 生成 sessionId、保存（过期时间）、访问续期、注销  
3. 用户接口  
   - POST /register（密码哈希占位，后续强化）  
   - POST /login -> sessionId  
   - POST /logout
4. 文件上传  
   - multipart/form-data 基础解析（首块+续块）  
   - FileUploadContext（边界、状态、已写字节）挂到 HttpContext  
   - 生成唯一存储名 + 原始名映射（JSON 小文件持久化）  
   - 上传完成写入 files 表（文件大小/类型/用户）
5. 文件下载  
   - Range 支持（bytes=start-end / start- / -suffix 基本）  
   - FileDownContext 分块（1MB）+ writeComplete 驱动续发  
   - HEAD 请求仅返回元信息  
6. 文件列表  
   - /files?type=my|shared|all 查询（关联 file_shares）  
7. 删除  
   - DELETE /delete/:filename（DB + 物理文件 + 分享记录清理）  
8. 分享  
   - POST /share（public / protected(提取码) / user 指定用户 / private 取消分享）  
   - GET /share/:code（元信息或页面）  
   - GET /share/download/:filename?code=...  
   - GET /share/info/:code（JSON）  
9. 用户搜索  
   - GET /users/search?keyword=xxx （模糊匹配 users）  
10. 静态资源  
   - index.html / register.html / share.html / player.js / favicon.ico 路由或统一静态文件处理

P2 增强与优化
1. 安全  
   - 密码哈希升级（bcrypt/argon2）  
   - SQL 注入防护（参数化或统一转义封装）  
   - 路径穿越防护（限制 uploads 根）  
   - 上传大小/并发限制（配置 + 超限返回 413）  
2. 性能  
   - sendfile / splice 优化下载  
   - 高水位 backpressure：暂停读/恢复读  
   - 简易 DB 连接池（复用 MySQL 连接）  
3. 可靠性  
   - 清理任务：过期 session / 过期分享 / 孤立文件定期扫描  
   - 大文件断点续传（分块合并）  
4. 可观测  
   - 统计指标（连接数/QPS/上传中/下载中/错误）  
   - 日志统一 JSON 或结构化（可选）  
5. 路由增强  
   - Trie 优先级 / 通配符匹配 / 中间件链（认证/鉴权）

实施顺序（推荐）
1. P0: 回调 & Buffer & Epoll 错误路径 → Connection 去耦 → HttpServer/Response/Context 改造 → 路由  
2. P1: DB + Session + Register/Login → 上传/下载最小实现 → 列表/删除 → 分享/搜索  
3. P2: 安全 & 性能 & 断点续传 & sendfile & 指标

最小 MVP 截止点
- 已完成：用户注册/登录、上传（单文件、流式或至少限制尺寸）、下载（支持 Range）、文件列表、删除
- 通过：基本并发（>100 并行上传+下载）无崩溃

你后续直接挑第一步（例如“先做回调体系补齐”）我可以给出具体改动补丁顺序。需哪个具体步骤的实现方案或代码草案，直接说明编号即可。